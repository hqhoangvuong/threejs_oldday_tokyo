import*as s from"https://unpkg.com/three@0.126.1/build/three.module.js";import{OrbitControls as G}from"https://unpkg.com/three@0.126.1/examples/jsm/controls/OrbitControls.js";import{RoomEnvironment as M}from"https://unpkg.com/three@0.126.1/examples/jsm/environments/RoomEnvironment.js";import{GLTFLoader as C}from"https://unpkg.com/three@0.126.1/examples/jsm/loaders/GLTFLoader.js";import{DRACOLoader as I}from"https://unpkg.com/three@0.126.1/examples/jsm/loaders/DRACOLoader.js";const O=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const t of n.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&c(t)}).observe(document,{childList:!0,subtree:!0});function d(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(e){if(e.ep)return;e.ep=!0;const n=d(e);fetch(e.href,n)}};O();var g=function(){var l=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(r){r.preventDefault(),c(++l%o.children.length)},!1);function d(r){return o.appendChild(r.dom),r}function c(r){for(var a=0;a<o.children.length;a++)o.children[a].style.display=a===r?"block":"none";l=r}var e=(performance||Date).now(),n=e,t=0,h=d(new g.Panel("FPS","#0ff","#002")),x=d(new g.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var y=d(new g.Panel("MB","#f08","#201"));return c(0),{REVISION:16,dom:o,addPanel:d,showPanel:c,begin:function(){e=(performance||Date).now()},end:function(){t++;var r=(performance||Date).now();if(x.update(r-e,200),r>=n+1e3&&(h.update(t*1e3/(r-n),100),n=r,t=0,y)){var a=performance.memory;y.update(a.usedJSHeapSize/1048576,a.jsHeapSizeLimit/1048576)}return r},update:function(){e=this.end()},domElement:o,setMode:c}};g.Panel=function(l,o,d){var c=1/0,e=0,n=Math.round,t=n(window.devicePixelRatio||1),h=80*t,x=48*t,y=3*t,r=2*t,a=3*t,m=15*t,u=74*t,p=30*t,w=document.createElement("canvas");w.width=h,w.height=x,w.style.cssText="width:80px;height:48px";var i=w.getContext("2d");return i.font="bold "+9*t+"px Helvetica,Arial,sans-serif",i.textBaseline="top",i.fillStyle=d,i.fillRect(0,0,h,x),i.fillStyle=o,i.fillText(l,y,r),i.fillRect(a,m,u,p),i.fillStyle=d,i.globalAlpha=.9,i.fillRect(a,m,u,p),{dom:w,update:function(R,D){c=Math.min(c,R),e=Math.max(e,R),i.fillStyle=d,i.globalAlpha=1,i.fillRect(0,0,h,m),i.fillStyle=o,i.fillText(n(R)+" "+l+" ("+n(c)+"-"+n(e)+")",y,r),i.drawImage(w,a+t,m,u-t,p,a,m,u-t,p),i.fillRect(a+u-t,m,t,p),i.fillStyle=d,i.globalAlpha=.9,i.fillRect(a+u-t,m,t,n((1-R/D)*p))}}};let H;const k=new s.Clock,S=document.getElementById("container"),T=new g;S.appendChild(T.dom);const f=new s.WebGLRenderer({antialias:!0});f.setPixelRatio(window.devicePixelRatio);f.setSize(window.innerWidth,window.innerHeight);f.outputEncoding=s.sRGBEncoding;S.appendChild(f.domElement);const W=new s.PMREMGenerator(f),E=new s.Scene;E.background=new s.Color(12575709);E.environment=W.fromScene(new M,.04).texture;const v=new s.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,100);v.position.set(5,2,8);const P=new G(v,f.domElement);P.target.set(0,.5,0);P.update();P.enablePan=!1;P.enableDamping=!0;const b=new I;b.setDecoderPath("src/gltf/");const A=new C;A.setDRACOLoader(b);A.load("assets/little_tokyo/LittlestTokyo.glb",function(l){const o=l.scene;o.position.set(1,1,0),o.scale.set(.01,.01,.01),E.add(o),H=new s.AnimationMixer(o),H.clipAction(l.animations[0]).play(),L()},void 0,function(l){console.error(l)});window.onresize=function(){v.aspect=window.innerWidth/window.innerHeight,v.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)};function L(){requestAnimationFrame(L);const l=k.getDelta();H.update(l),P.update(),T.update(),f.render(E,v)}
